inline C <<end
#include "prim.h"
#include "pbox.h"

static void
fin_test_fn(void *i)
{
    if (i == (void *) 3) {
        prfmt(1, "success\n");
    } else {
        prfmt(1, "FAIL %p\n", i);
    }
}

end

def (f.):
  def make-box: obj ():
    inline C (run.) <<end
      return make_pbox((void *) 3, fin_test_fn);
    end
  make-box.
  #def pbox (make-box.)
  #obj ()

export f
